# Global settings for the whole stack
global:
  imagePullPolicy: IfNotPresent
  imageRegistry: ""   # optional; we use full image repo below

frontend:
  enabled: true
  image:
    # Built and pushed by the GitHub Actions workflow in the app repo
    repository: ghcr.io/doda25-team23/app
    tag: "latest"          # can be overridden with --set or -f
  replicaCount: 1
  service:
    type: ClusterIP
    port: 80               # cluster port; forwards to containerPort below
  containerPort: 8080      # APP_PORT default in Dockerfile
  metrics:
    enabled: true
    port: 8080             # /metrics will live on same port as the app
    path: /actuator/prometheus

modelService:
  enabled: true
  image:
    repository: ghcr.io/doda25-team23/model-service
    tag: "latest"
  replicaCount: 1
  service:
    type: ClusterIP
    port: 8081             # cluster port; forwards to containerPort below
  containerPort: 8081      # MODEL_PORT default in Dockerfile
  metrics:
    enabled: true
    port: 8081             # /metrics on same port
    path: /metrics

ingress:
  enabled: true
  className: "nginx"
  hosts:
    - host: app.team23.doda.local      # TA will override during grading
      paths:
        - path: /
          pathType: Prefix

prometheus:
  enabled: true
  # details will be added later (deployment/service/servicemonitor)

grafana:
  enabled: true
  # dashboards wired later via ConfigMap

# Common labels used for ServiceMonitor matching
monitoring:
  enabled: true
  scrapeInterval: 15s
  labels:
    release: app-stack

# Alerting configuration
alerting:
  enabled: true
  # Webhook receiver (easiest to test - no SMTP needed!)
  webhook:
    enabled: true
    # Use a webhook testing service like https://webhook.site or your own endpoint
    url: "https://webhook.site/your-unique-id"  # UPDATE THIS - get a unique URL from webhook.site
    # Or use a simple HTTP endpoint that logs alerts
    # url: "http://your-logging-service:8080/alerts"
  
  # Email receiver (optional - requires SMTP setup)
  email:
    enabled: false  # Set to true if you want email alerts
    # Email recipient for alerts
    to: "dev-team@example.com"  # UPDATE THIS with your email
    # SMTP configuration - these values should be provided via --set or from a Secret
    # DO NOT commit real credentials to git!
    smtpFrom: "alerts@example.com"  # UPDATE THIS
    smtpHost: "smtp.example.com"  # UPDATE THIS (e.g., smtp.gmail.com)
    smtpPort: "587"  # UPDATE THIS (587 for TLS, 465 for SSL)
    smtpAuthUsername: "your-email@example.com"  # UPDATE THIS
    smtpAuthPassword: "your-password"  # UPDATE THIS - use --set or Secret in production!
